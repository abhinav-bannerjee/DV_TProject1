{
    "contents" : "setwd(\"/Users/CK/DataVisualization/DV_RProject3/01 Data\")\n\nfile_path <- \"1990.csv\"\n\ndf <- read.csv(file_path)\n\n\n# Replace \".\" (i.e., period) with \"_\" in the column names.\nnames(df) <- gsub(\"\\\\.+\", \"_\", names(df))\n\n#str(df) # Uncomment this and  run just the lines to here to get column types to use for getting the list of measures.\n\nmeasures <- c(\"percent\",\"cumulative_percent\",\"rank\")\n\n#measures <- NA # Do this if there are no measures.\ndimensions <- setdiff(names(df), measures)\n\n\nif( length(measures) > 1 || ! is.na(dimensions)) {\n  for(d in dimensions) {\n    # Get rid of \" and ' in dimensions.\n    df[d] <- data.frame(lapply(df[d], gsub, pattern=\"[\\\"']\",replacement= \"\"))\n    # Change & to and in dimensions.\n    df[d] <- data.frame(lapply(df[d], gsub, pattern=\"&\",replacement= \" and \"))\n    # Change : to ; in dimensions.\n    df[d] <- data.frame(lapply(df[d], gsub, pattern=\":\",replacement= \";\"))\n  }\n}\n\n\nlibrary(lubridate)\nif( length(measures) > 1 || ! is.na(measures)) {\n  for(m in measures) {\n    df[m] <- data.frame(lapply(df[m], gsub, pattern=\"[^--.0-9]\",replacement= \"\"))\n  }\n}\n\nwrite.csv(format(df, scientific = NA), paste(gsub(\".csv\", \"\", file_path), \"re.csv\", sep=\"\" ), row.names=FALSE, na = \"\")\n\ntableName <- gsub(\" +\", \"_\", gsub(\"[^A-z, 0-9, ]\", \"\", gsub(\".csv\", \"\", file_path)))\nsql <- paste(\"CREATE TABLE\", tableName, \"(\\n-- Change table_name to the table name you want.\\n\")\nif( length(measures) > 1 || ! is.na(dimensions)) {\n  for(d in dimensions) {\n    sql <- paste(sql, paste(d, \"varchar2(4000),\\n\"))\n  }\n}\nif( length(measures) > 1 || ! is.na(measures)) {\n  for(m in measures) {\n    if(m != tail(measures, n=1)) sql <- paste(sql, paste(m, \"number(38,4),\\n\"))\n    else sql <- paste(sql, paste(m, \"number(38,4)\\n\"))\n  }\n}\nsql <- paste(sql, \");\")\ncat(sql)\n",
    "created" : 1446519691712.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4153189507",
    "id" : "B68E5581",
    "lastKnownWriteTime" : 1444966774,
    "path" : "~/DataVisualization/DV_RProject2/01 Data/R_Etl.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}