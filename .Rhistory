COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=9) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="white", hjust=-0.5),
position=position_identity()
)+ layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
)
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=2) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="white", hjust=-0.5),
position=position_identity()
)+ layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
)
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="white", hjust=-0.5),
position=position_identity()
)+ layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
)
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
)
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
) +coord_flip()
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip()
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=DIVISION, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip()
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
#facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=DIVISION, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
#facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=DIVISION, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
)
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
#facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=DIVISION, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
#facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=df,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
df <- na.omit(df)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
#facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=COMB_FE_,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
df <- na.omit(df)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=COMB_FE_,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
df[df =="null"]<-NA
df <- na.omit(df)
require("jsonlite")
require("RCurl")
# Change the USER and PASS below to be your UTEid
df <- data.frame(fromJSON(getURL(URLencode('skipper.cs.utexas.edu:5001/rest/native/?query="select * from FE1"'),httpheader=c(DB='jdbc:oracle:thin:@sayonara.microlab.cs.utexas.edu:1521:orcl', USER='C##cs329e_kc35827', PASS='orcl_kc35827', MODE='native_mode', MODEL='model', returnDimensions = 'False', returnFor = 'JSON'), verbose = TRUE), ))
df[TRANS_DESC =="null"] <-NA
df[df$TRANS_DESC =="null"] <-NA
df$TRANS_DESC[df$TRANS_DESC =="null"] <-NA
df <- na.omit(df)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
df$TRANS_DESC[df$TRANS_DESC =="null"] <-NA
df <- na.omit(df)
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=COMB_FE_,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
KPI_Low = 20;
KPI_Medium = 31;
a <- df  %>% select(TRANS_DESC,DRIVE_DESC,CARLINE,COMB_FE_GUIDE,FE_RATING_1_10)%>% group_by(TRANS_DESC,DRIVE_DESC) %>% summarise(comb_fe = round(mean(as.numeric(as.character(COMB_FE_GUIDE))),2),fe_rating = round(mean(as.numeric(as.character(FE_RATING_1_10))),digits=1))
a<-na.omit(a)
a <- a%>% mutate(KPI_COMB_FUEL = ifelse(as.numeric(as.character(comb_fe)) < KPI_Low, 'Less than 20', ifelse(as.numeric(as.character(comb_fe)) < KPI_Medium, 'Between 20 and 30', 'Greater than 30')))
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
scale_x_discrete(labels=c("Automated Manual","Automated Manual- Selectable","Automatic","Continuously Variable","Manual","Selectable Continuously Variable","Semi-Automatic") )+
labs(title='CROSSTAB') +
labs(x=paste("Transmission"), y=paste("Drive")) +
layer(data=a,
mapping=aes(x=TRANS_DESC, y=DRIVE_DESC,fill=KPI_COMB_FUEL),
stat="identity",
stat_params=list(),
geom="tile",
geom_params=list(alpha=0.50),
position=position_identity()
)+
layer(data=a,
mapping=aes(x=TRANS_DESC, y=DRIVE_DESC, label= fe_rating),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", vjust =2),
position=position_identity()
)+
layer(data=a,
mapping=aes(x=TRANS_DESC, y=DRIVE_DESC, label= comb_fe),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="black", vjust =4),
position=position_identity()
)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE,DIVISION)
COMB_FE_[COMB_FE_=="null"] <- NA
df$TRANS_DESC[df$TRANS_DESC =="null"] <-NA
df <- na.omit(df)
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=COMB_FE_,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
COMB_FE_ <- df %>% select(COMB_FE_GUIDE)
COMB_FE_[COMB_FE_=="null"] <- NA
df$TRANS_DESC[df$TRANS_DESC =="null"] <-NA
df <- na.omit(df)
COMB_FE_ <- na.omit(COMB_FE_)
COMB_FE_$COMB_FE_GUIDE <- as.numeric(as.character(COMB_FE_$COMB_FE_GUIDE))
comb_fe <- colMeans(COMB_FE_)
ggplot() +
coord_cartesian() +
scale_x_discrete() +
scale_y_discrete() +
facet_wrap(~DIVISION, ncol=6) +
labs(title='Fuel Economy per Division  ') +
labs(x=paste("DIVISION"), y=paste("COMB FE GUIDE")) +
layer(data=COMB_FE_,
mapping=aes(yintercept = comb_fe-11),
geom="hline",
geom_params=list(colour="red")
) +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=COMB_FE_GUIDE),
stat="identity",
stat_params=list(),
geom="bar",
geom_params=list(colour="green"),
position=position_identity()
) + coord_flip() +
layer(data=df,
mapping=aes(x=TRANS_DESC, y=(COMB_FE_GUIDE), label=(COMB_FE_GUIDE)),
stat="identity",
stat_params=list(),
geom="text",
geom_params=list(colour="red", hjust=-0.5),
position=position_identity()
)
